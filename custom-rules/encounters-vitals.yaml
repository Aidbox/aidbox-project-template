aidbox.ccda.rules.encounters/narrative:
  select:
    - selector:
        cda:  [text 0 cols 1]
        fhir: [entry * type 0]
      override:
        cda:  [text 0 cols 1]
        fhir: [entry * class]
    - selector:
        cda: [text 0 cols 2]
        fhir: [entry * location 0 location address]
      override:
        cda: [text 0 cols 2]
        fhir: [entry * location 0 location type 0]
aidbox.ccda.rules.shared.encounter/rules:
  select:
    - selector:
        cda: [code]
        fhir: [type 0]
        id: enc-code
      override:
        cda: [code]
        fhir: [class]
        cda/default:
          -nullFlavor: UNK
          cda/type: const
  remove:
    - selector:
        fhir: [class]
aidbox.ccda.rules.shared.problem-observation/rules:
  select:
    - selector:
        cda: [code]
      override:
        cda: [code]
        cda/const:
          -xsi:type: CD
          cda/type: const
          -code: 282291009
          -displayName: Diagnosis
          -codeSystemName: SNOMED-CT
          -codeSystem: 2.16.840.1.113883.6.96
          translation:
            -nullFlavor: UNK
aidbox.ccda.rules.vital-signs/narrative:
  replace:
    - cda: [text 0]
      const:
        type: table
        header:
          - Vital sign
          - Date
          - Value and units
    - fhir: [entry *]
      cda: [text 0 rows]
      apply-rules:
        - fhir: [code]
          cda: [0]
        - fhir: [effective]
          cda: [1]
        - fhir: [value]
          cda: [2]
